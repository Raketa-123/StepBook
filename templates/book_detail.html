<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>{{ book.title }} ‚Äî StepBook</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg1:#0f1720;   /* very dark */
      --bg2:#0b1220;   /* gradient */
      --card: rgba(255,255,255,0.04);
      --muted: #9fb3d6;
      --accent: #8fbfff;
      --accent-2: #9b8bff;
      --gold: #ffda79;
      --glass-border: rgba(255,255,255,0.06);
      --radius: 14px;
      --shadow: 0 10px 30px rgba(2,6,23,0.6);
    }

    html,body{height:100%;margin:0;font-family: Inter, "Segoe UI", Tahoma, sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaf2ff;-webkit-font-smoothing:antialiased;}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:40px 20px;}
    .card{
      width:100%;
      max-width:760px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      padding:28px;
      box-shadow:var(--shadow);
      border:1px solid var(--glass-border);
      backdrop-filter: blur(8px) saturate(120%);
    }

    .top{
      display:flex;
      gap:24px;
      align-items:flex-start;
      margin-bottom:18px;
    }

    .cover{
      width:200px;
      min-width:140px;
      height: 280px;
      border-radius:10px;
      overflow:hidden;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.2));
      box-shadow: 0 8px 30px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .cover img{width:100%;height:100%;object-fit:cover;display:block;}

    .meta{flex:1;}
    h1{margin:0;font-size:22px;letter-spacing:0.2px}
    .author{margin-top:6px;color:var(--muted);font-size:14px;font-style:italic}
    .description{margin-top:14px;color: #d7e8ff;line-height:1.55;}
    .price{
      margin-top:14px;
      font-weight:700;
      color:var(--gold);
      font-size:18px;
    }

    .actions{margin-top:20px;display:flex;gap:12px;flex-wrap:wrap;align-items:center;}
    .btn{
      padding:10px 16px;border-radius:10px;text-decoration:none;font-weight:700;border:none;cursor:pointer;
      transition: transform .14s ease, box-shadow .14s ease;
      display:inline-flex;align-items:center;gap:10px;
    }
    .btn--ghost{
      background:transparent;color:#cfe7ff;border:1px solid rgba(255,255,255,0.06);
      backdrop-filter: blur(6px);
    }
    .btn--primary{
      background: linear-gradient(90deg,var(--accent),var(--accent-2));
      color: #041028;
      box-shadow: 0 6px 20px rgba(67,109,189,0.16);
    }
    .btn:hover{transform:translateY(-4px)}
    .btn--download{background:linear-gradient(90deg,#fff3d9,#ffea9a);color:#07203a}

    .back-link{color:var(--muted);font-size:14px;text-decoration:none;margin-right:auto}
    .small{font-size:13px;color:var(--muted);margin-top:8px}

    @media (max-width:640px){
      .top{flex-direction:column;align-items:center}
      .cover{width:160px;height:230px}
      .meta{text-align:center}
      .back-link{display:block;margin:0 auto 6px}
      .actions{justify-content:center}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <article class="card">
      <div class="top">
        <div class="cover">
          {% if book.cover %}
            <img src="{{ book.cover.url }}" alt="{{ book.title }}">
          {% else %}
            <svg width="60" height="80" viewBox="0 0 60 80" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
              <rect width="60" height="80" rx="6" fill="#16202b"/>
            </svg>
          {% endif %}
        </div>

        <div class="meta">
          <h1>{{ book.title }}</h1>
          <div class="author">{{ book.author }}</div>
          <div class="small">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ book.published_date|default:"‚Äî" }}</div>

          <p class="description">{{ book.description }}</p>
          <div class="price">{{ book.price }} ‚ÇΩ</div>

          <div class="actions">
            {% if purchased %}
              <a class="btn btn--download" href="{{ book.file.url }}" download>üì• –°–∫–∞—á–∞—Ç—å PDF</a>
              <a class="btn btn--ghost" href="{% url 'home_page' %}">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
            {% else %}
              <form method="post" action="{% url 'buy_book' book.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn--primary">üí≥ –ö—É–ø–∏—Ç—å –∑–∞ {{ book.price }}‚ÇΩ</button>
              </form>
              <a class="btn btn--ghost" href="{% url 'home_page' %}">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è</a>
            {% endif %}
            {% if book.owner == request.user %}
              <form method="get" action="{% url 'delete_book' book.id %}">
                  <button style="margin-top:15px;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É</button>
              </form>
            {% endif %}
          </div>
        </div>
      </div>
    </article>
  </div>
</body>
</html>
